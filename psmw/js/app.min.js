/**
 * Premium Stock Market Widgets
 * ---------------------------------------------
 * Version 1.8.6, built on Wednesday, January 10, 2018
 * Copyright (c) Financial Apps and Plugins <info@financialplugins.com>. All rights reserved.
 * Demo: https://financialplugins.com/products/premium-stock-market-widgets
 * Purchase: https://codecanyon.net/item/premium-stock-market-widgets-js-php/19714578?ref=financialtechnology
 * Like: https://www.facebook.com/financialplugins/
 */
var smwPathToAssets=smwPathToAssets||"",smwGlobals={debug:!1,code:"smw",ajaxUrl:smwPathToAssets+"/psmw/ajax.php",pluginUrl:smwPathToAssets+"/psmw/",dependencies:{marquee:smwPathToAssets+"/psmw/vendor/jquery.marquee/jquery.marquee.min.js",tablesort:smwPathToAssets+"/psmw/vendor/jquery.tablesort/jquery.tablesort.min.js",sparkline:smwPathToAssets+"/psmw/vendor/jquery.sparkline/jquery.sparkline.min.js",chart:smwPathToAssets+"/psmw/vendor/chart.js/Chart.min.js"}},premiumStockMarketWidgetsPlugin=function(e){function a(a){return f=e(document),p=e(g),m("Initialize",p.length+" widgets"),h=e.Deferred(),y=e.Deferred(),e.when(h,y).done(function(){p.trigger("psmwReadyGlobal")}),0!=p.length&&(l(p),f.off("psmwReadyGlobal",g).off("mouseenter",g+" .smw-combo table tbody tr"),f.on("psmwReadyGlobal",g,i).on("click",".smw-modal-close",function(){e(this).closest(".smw-modal").hide()}),void t(p,a))}function t(a,t){o(a);var t="undefined"==typeof t||t,n=s(a),i=[],l=[],d=[],c=e(),u=e(),f=e();a.each(function(a,t){var s=e(t),r=s.data("symbol"),o=s.data("source"),n=s.data("type");if("live"==o){c=c.add(s);for(var m=r?r.split(","):[],p=0;p<m.length;p++)e.inArray(m[p],i)<0&&i.push(m[p])}else"history"==o&&("spark"==n?(l.push(r),u=u.add(s)):"chart"==n&&(d.push(r),f=f.add(s)))});var p=l.length,h=d.length;x+=p+h+(i.length?1:0),m("Number of AJAX calls to make",x);for(var y=0;y<p;y++){var v=u.eq(y);r(v,{source:"history",symbols:l[y].split(","),type:"spark"},t)}for(var y=0;y<h;y++){var g=f.eq(y);r(g,{source:"history",symbols:d[y].split(","),type:"chart",chart_range:g.data("range"),chart_interval:g.data("interval")},t)}i.length&&n.length&&r(c,{source:"live",symbols:i,fields:n},t)}function s(a){var t=[];return a.find(b).each(function(a,s){var s=e(s).data("field").replace("_","");e.inArray(s,t)<0&&t.push(s)}),t}function r(a,t,s,r){s?(m("Get market data from SERVER",t.source,t),e.isEmptyObject(t)||e.ajax({method:smwGlobals.ajaxMethod,url:smwGlobals.ajaxUrl,dataType:"json",cache:!1,context:{source:t.source,symbol:t.symbols,$widgetContainers:a},data:{params:t},success:function(a){m("Market data received",this.source,a),x--,a.success?(e.extend(!0,q,a.data),m("Market data cached",q),"function"==typeof t.callback?t.callback():n(this.$widgetContainers,q)):m("ERROR response received",a.data)}})):(m("Get market data from CACHE",t.source,t),x--,n(a,q))}function o(a){a.each(function(a,t){var s=e(t).data("dependency");if(s){s=s.split(",");for(var r=0;r<s.length;r++)e.inArray(s[r],A)<0&&A.push(s[r])}});var t=A.length;if(t>C)for(var s=0;s<t;s++){var r=smwGlobals.dependencies[A[s]];"undefined"==typeof j[r]&&(m("Loading JS file",r),j[r]=e.ajax({url:r,dataType:"script",cache:!0}).done(function(){C++,m("JS file loaded",r),C==A.length&&(m("All plugins loaded"),y.resolve())}))}else y.resolve()}function n(a,t){a.each(function(a,s){var r=e(s);r.find(b).each(function(a,s){var o=e(s),n=o.data("field"),i=o.data("symbol")?o.data("symbol"):r.data("symbol"),l="undefined"!=typeof t[i]&&"undefined"!=typeof t[i][n]?t[i][n]:"";o.addClass("smw-field-"+n.replace(".","-")),["virtual.symbolLink","virtual.nameLink"].indexOf(n)===-1?o.text(l):o.html(l);var d=o.data("previous-value");"undefined"!=typeof d&&d!=l&&o.animate({opacity:0},200).animate({opacity:1},200).animate({opacity:0},200).animate({opacity:1},200),o.data("previous-value",l)}),r.find(w).each(function(a,s){var o=e(s),n=o.data("symbol")?o.data("symbol"):r.data("symbol"),i="undefined"!=typeof t[n]&&"undefined"!=typeof t[n]["quote.regularMarketChange"]?parseFloat(t[n]["quote.regularMarketChange"]):0;i>0?o.removeClass("smw-drop").addClass("smw-rise"):i<0?o.removeClass("smw-rise").addClass("smw-drop"):o.removeClass("smw-drop smw-rise")})}),0==x&&(m("All AJAX requests completed"),h.resolve())}function i(a){if(a.target){var t=e(a.target);m("psmwReadyGlobal",t.attr("id"),t.attr("class")),t.hasClass("smw-visible")||t.addClass("smw-visible")}}function l(e){e.each(function(e,a){var t=a.className.split(/\s+/);t.length>=3&&d(smwGlobals.pluginUrl+"templates/"+t[1].substr(4)+"/"+t[2].substr(4)+"/style.css")})}function d(a){e.inArray(a,k)<0&&(m("Loading CSS file",a),e("<link>").appendTo("head").attr({type:"text/css",rel:"stylesheet",href:a}),k.push(a))}function c(e,a){var t=parseFloat(e.replace(/[^0-9.-]/g,"")),s=parseFloat(a.replace(/[^0-9.-]/g,""));return e&&a&&!isNaN(t)&&!isNaN(s)?t>s?1:t<s?-1:0:e.localeCompare(a)}function u(){var e=window.navigator.userAgent;return e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0}function m(){0!=smwGlobals.debug&&console.log("PSMW",arguments)}m("globals",smwGlobals);var f,p,h,y,v=smwGlobals.code,g="."+v,b="."+v+"-market-data-field",w="."+v+"-change-indicator",k=[],j={},A=[],C=0,x=0,q={};return e(document).ready(function(){a(!0)}),"undefined"==typeof Number.prototype.formatNumber&&(Number.prototype.formatNumber=function(){var e="undefined"!=typeof arguments[0]?arguments[0]:2,a="undefined"!=typeof arguments[1]?arguments[1]:"en-US";return this.toLocaleString(a,{minimumFractionDigits:e,maximumFractionDigits:e})}),{init:a,getMarketData:function(){return q},getWidgetsFields:s,retrieveMarketData:r,tablesortCompare:c,checkIE:u,log:m}}(jQuery);